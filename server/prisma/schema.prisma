generator client {
  provider = "prisma-client-js"
  previewFeatures = ["referentialActions"]
}

generator dbml {
  provider = "prisma-dbml-generator"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_DATABASE_URL")
}

model Session {
	id 				Int 		@id	@default(autoincrement())
	userId			Int
	token 			String
	expiresAt		DateTime
	data			String?
	createdAt		DateTime 	@default(now())
	updatedAt		DateTime 	@updatedAt
	user			User	 	@relation(fields: [userId], references: [id])

	@@index([expiresAt])
}

model Team {
	id				Int			@id @default(autoincrement())
	name 			String
	ownerEmail		String?	
	startDate		DateTime
	endDate			DateTime
	status			String		@default("Doing")
	picture 		String		@default("https://cdn2.psychologytoday.com/assets/styles/manual_crop_1_91_1_1528x800/public/2020-08/shutterstock_1731284125_0.jpg?itok=89UrdUt_")		
	numOfMember		Int			@default(1)
	description		String?
	members			Member[]	
}

model Member {
	user			User 		@relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
	team			Team		@relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: Cascade)
	isOwner			Boolean		@default(false)
	userId			Int
	teamId 			Int
 	joinedAt		DateTime 	@default(now())
 	assignedBy 		String

	@@unique([userId, teamId])
}

model User {
	id				Int			@id @default(autoincrement())
	name			String
	email			String		@unique
	createAt 		DateTime 	@default(now())
	picture			String?	
	updateAt		DateTime 	@updatedAt
	isAdmin			Boolean	 	@default(false)
	status 			String		@default("NotInitiated")
	session			Session[]
	members			Member[]
	profile			Profile?

 	 @@index([email])
}

model Profile {
  id   				Int		 	@id @default(autoincrement())
  User 				User		@relation(fields: [userId], references: [id])
  userId			Int
}