generator client {
  provider = "prisma-client-js"
  previewFeatures = ["referentialActions"]
}

generator dbml {
  provider = "prisma-dbml-generator"
}

datasource db {
  provider = "postgresql"
  url      = env("POSTGRES_DATABASE_URL")
}

model Session {
	id 				Int 		@id	@default(autoincrement())
	userId			Int
	token 			String
	expiresAt		DateTime
	data			String?
	createdAt		DateTime 	@default(now())
	updatedAt		DateTime 	@updatedAt
	user			User	 	@relation(fields: [userId], references: [id])

	@@index([expiresAt])
}

model Team {
	id				Int			@id @default(autoincrement())
	name 			String
	ownerEmail		String[]
	createdAt 		DateTime 	@default(now())
	startDate		DateTime
	endDate			DateTime
	status			String		@default("Doing")
	picture 		String		@default("https://cdn2.psychologytoday.com/assets/styles/manual_crop_1_91_1_1528x800/public/2020-08/shutterstock_1731284125_0.jpg?itok=89UrdUt_")		
	numOfMember		Int			@default(1)
	isPublish 		Boolean		@default(true)
	description		String?
	teamToken 		TeamToken[]
	members			Member[]	
}

model Member {
	user			User 		@relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: Cascade)
	team			Team		@relation(fields: [teamId], references: [id], onDelete: Cascade, onUpdate: Cascade)
	isOwner			Boolean		@default(false)
	userId			Int
	teamId 			Int
 	joinedAt		DateTime 	@default(now())
 	assignedBy 		String?

	@@unique([userId, teamId])
}

model User {
	id				Int			@id @default(autoincrement())
	email			String		@unique
	nickname		String		@default("Not set")
	picture			String		@default("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAOEAAADhCAMAAAAJbSJIAAAAMFBMVEXg4OC9vb3f39/Kysrc3Ny+vr7Q0NDHx8fNzc3ExMTU1NTV1dXY2NjBwcG6urrLy8vXjdnDAAAEKElEQVR4nO3d63KrIBQF4IAIBgXf/22P5GpbEwGVzfasb6bTv6zhoiCQywUAAAAAAAAAAAAAAAAAAAAAAABgiVTW6k5bqyR1UQ6gbOP8RAgR/rnGKuoi7ao3bcg251vTUxdrN/31d7xHyOs5Miq3nO+W0Z2grXaf890ydtQF3Eh+aKDzpsp6YFXtSr6gZdxSh4h8wUBd0FwqMqAQTGtRxjTRR0Pl2Rev0QGFuFIXNsfKY+Injg+N2FHmid9ok9JGA3bt1Ka00cBb6iIncokBhXDURU7Tp1bhVIm8JhqpvTBg1RPj32bmOL3Z6PRGymysMVl1aKiLHU+mj6SB4/N2qnIa6dRM+XTEITMhnze3rIFmSqipCx6tywooBJ8JxvkTNpkJG+qCRzt/HZ4/oc5MyGcszZg7BYzmT+d/p0lYKZ3jtGqaMwHmNQXOmx/yGWj+hzn++ddp0pdLmS1iTDLqkLrIiZLHGlbjTJC8VMNokeYhsScyemN7SVtRZLSS+JLUTvm10SDlsc/qYf8WPYni2AnvbGRCZs/6uT4qINsaDIb1mWLLZ6V7kTQrexMNy1H0B/tne/AsX8u4C77J7kNG33b8K/BO6oV9wt7ps+S7Ud30ivOMOf13HdOH/DdqsF1jjGk6O5wwHgAAAAAAAMBFymn2a3U3Nk1jpr8xXDswKHmGVYwwrzeu9Y/LBmarNEHrDOf5vhy0ccKvnnT2whk9sKvOYUz+BjzyWftW+iqydgyJq2bQYnPjcQlpt8R7hax2pV91m+M9Q1a5XDysfGRKDGlqG3f2zVdfRpW3n3TNtZa2Kse96+/Jj1W8CHz7Aro5YgVfUNe+Ym/OSP0VPGInwla0OxmS7r7IRXlnxsEt9BWRalufPOYZsYTmLqnMYyN5WoqA5WowINieWTYgwVmFpswg8+YLHzDNOE+xOWLR1xtZPF9QsivmHmXepmA7zTu4tV252RRNFRasxKLP+rlih0wzDzJvV2xPf+5x++1KzTLybhDaQ6lJRt4NQnsodafb+evw/GNp5FGY/RU8XFN8ZhGUnV1QDDZlr46keDMtvMZfvisWP+GWeWNZLorD7Id9j1kMOJYPWGw9+BaQaE244IowTcByEQlvPSkTkfRal9Wfr9jOE99bc/hwQ/bh6eXgT4g1XLife8FenCpurTnwS3ctZ/XVQeONr2ZDzVGrbxV0wbdh/wmjq6SFPsmdp/2+qWI71A/Dl18fS85XWwU+6L0G1baKZ8QStc9HqaaeIfQvtbk7+qrzBRvrsfp8gfp0W8tq9fG5DkRak7yp3Qtj63tAfKG0Wz0QNIvnXeXnLBYpa+IeH63h+8Oyt9NdX+pyqjuOp7p+kaq/H2Lzs98D9vcja/2pfvtYDb21WndaW9vzPXQIAAAAAAAAAAAAAAAAAAAAAAAAh/oHOVI0YSQb7ewAAAAASUVORK5CYII=")
	createdAt 		DateTime 	@default(now())
	updatedAt 		DateTime	@updatedAt
	isAdmin			Boolean	 	@default(false)
	status 			String		@default("NotInitiated")
	session			Session[]
	profile			UserProfile?
	members			Member[]

 	 @@index([email])
}

model TeamToken {
	id				Int 		@id @default(autoincrement())	
	teamId			Int
	inviteEmail 	String
	value			String
 	expiredAt       DateTime
  	usedAt          DateTime?
  	createdAt       DateTime    @default(now())
  	updatedAt       DateTime    @updatedAt
	team			Team		@relation(fields: [teamId], references: [id])
}

model UserProfile {
	id				Int			@id @default(autoincrement())
 	User 			User		@relation(fields: [userId], references: [id])
	userId			Int
	firstName		String
	lastName		String
	gender			String		@default("Unspecified")
	workplace		String?
	userStatus		String?		@default("online")
	school			String?
	introduction 	String?
	phoneNumber		String[]
	photos			String[]
	talents			String?
	interests		String?
	createdAt		DateTime	@default(now())
	updatedAt		DateTime	@updatedAt

	@@unique([userId])
}

// model Contact {
// 	id				Int			@id	@default(autoincrement())
// 	userProfileId	Int			
// 	firstName		String
// 	middleName		String
// 	lastName		String
// 	phoneNumbers	String[]		
// 	email			String
// }

// model UserStatus {
// 	id 				Int 		@id @default(autoincrement())
// 	status 			String
// 	updateTime 		DateTime	@updatedAt
// }

// model Gender {
// 	id				Int			@id	@default(autoincrement())
// 	type			String	

// 	@@unique([type])
// }
